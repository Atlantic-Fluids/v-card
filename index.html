<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Atlantic Fluids | Responsive Profile</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0066CC;
            --secondary: #004799;
            --background: #F8FAFC;
            --card-bg: #FFFFFF;
            --text: #1E293B;
            --border: #E2E8F0;
            --shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
        }

        body {
            background: var(--background);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            color: var(--text);
            line-height: 1.5;
        }

        .vcard-container {
            background: var(--card-bg);
            width: 100%;
            max-width: 1200px;
            border-radius: 1.5rem;
            box-shadow: var(--shadow);
            overflow: hidden;
            margin: 1rem;
        }

        /* Header Section */
        .header-section {
            padding: clamp(2rem, 5vw, 4rem) 1rem;
            background: var(--primary);
            text-align: center;
            position: relative;
        }

        .company-logo {
            width: clamp(100px, 25vw, 160px);
            height: clamp(100px, 25vw, 160px);
            margin: 0 auto 1.5rem;
            background: var(--card-bg);
            border-radius: 1rem;
            padding: 0.5rem;
            box-shadow: var(--shadow);
        }

        .company-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .company-name {
            color: var(--card-bg);
            font-size: clamp(1.75rem, 6vw, 2.5rem);
            font-weight: 700;
            margin-bottom: 0.5rem;
            padding: 0 1rem;
            word-wrap: break-word;
        }

        /* Main Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(300px, 100%), 1fr));
            gap: 1.5rem;
            padding: clamp(1.5rem, 3vw, 3rem);
        }

        .info-card {
            background: var(--card-bg);
            border-radius: 1rem;
            padding: clamp(1rem, 2vw, 2rem);
            border: 1px solid var(--border);
            transition: var(--transition);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border);
        }

        .card-icon {
            width: clamp(36px, 8vw, 48px);
            height: clamp(36px, 8vw, 48px);
            background: var(--primary);
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: clamp(1rem, 2vw, 1.25rem);
            flex-shrink: 0;
        }

        .card-title {
            font-size: clamp(1.1rem, 3vw, 1.25rem);
            font-weight: 600;
            color: var(--primary);
        }

        .card-content {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .contact-item {
            padding: 0.75rem;
            background: var(--background);
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: var(--transition);
            min-height: 56px;
        }

        .contact-link {
            color: var(--text);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 100%;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        .contact-link i {
            color: var(--primary);
            font-size: clamp(1rem, 2vw, 1.1rem);
            min-width: 24px;
        }

        .social-section {
            padding: clamp(1rem, 2vw, 2rem);
            background: var(--background);
            border-top: 1px solid var(--border);
        }

        .social-grid {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .social-item {
            padding: 0.75rem 1.25rem;
            background: var(--card-bg);
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            color: var(--text);
            border: 1px solid var(--border);
            transition: var(--transition);
            font-size: clamp(0.9rem, 2vw, 1rem);
            flex: 1 1 auto;
            min-width: 160px;
            max-width: 240px;
            justify-content: center;
        }

        .error-container {
            padding: 2rem;
            text-align: center;
            color: #dc3545;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .error-container i {
            font-size: 3rem;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .content-grid {
                gap: 1rem;
                padding: 1.5rem;
            }

            .card-header {
                gap: 0.5rem;
                margin-bottom: 0.75rem;
            }

            .contact-item {
                padding: 0.5rem;
                min-height: 48px;
            }

            .social-item {
                min-width: 140px;
                padding: 0.75rem 1rem;
            }
        }

        @media (max-width: 480px) {
            .vcard-container {
                border-radius: 1rem;
                margin: 0.5rem;
            }

            .header-section {
                padding: 1.5rem 0.5rem;
            }

            .content-grid {
                padding: 1rem;
                gap: 0.75rem;
            }

            .info-card {
                padding: 1rem;
                border-radius: 0.75rem;
            }

            .card-header {
                padding-bottom: 0.75rem;
            }

            .social-item {
                width: 100%;
                max-width: 100%;
                min-width: unset;
            }

            .contact-link span {
                word-break: break-all;
            }
        }

        @media (hover: hover) {
            .contact-item:hover {
                transform: translateX(8px);
                box-shadow: var(--shadow);
            }

            .social-item:hover {
                background: var(--primary);
                color: white;
            }
        }
    </style>
</head>
<body>
    <div class="vcard-container">
        <header class="header-section">
            <div class="company-logo" id="companyLogo">
                <img src="logo1.jpg" alt="Atlantic Fluids Logo">
            </div>
            <h1 class="company-name" id="fullName">Atlantic Fluids</h1>
        </header>

        <main>
            <div class="content-grid">
                <!-- Contact Cards -->
                <div class="info-card">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <h2 class="card-title">Email Addresses</h2>
                    </div>
                    <div class="card-content" id="emails"></div>
                </div>

                <div class="info-card">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <h2 class="card-title">Phone Numbers</h2>
                    </div>
                    <div class="card-content" id="phones"></div>
                </div>

                <div class="info-card">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fas fa-globe"></i>
                        </div>
                        <h2 class="card-title">Website</h2>
                    </div>
                    <div class="card-content">
                        <a id="website" href="#" class="contact-item contact-link">
                            <i class="fas fa-external-link-alt"></i>
                            <span>Loading website...</span>
                        </a>
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <h2 class="card-title">Address</h2>
                    </div>
                    <div class="card-content">
                        <div id="address" class="contact-item">
                            <i class="fas fa-building"></i>
                            <span>Loading address...</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="social-section">
                <div class="social-grid" id="social-links"></div>
            </div>
        </main>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script>
        // Firebase configuration and initialization
        const firebaseConfig = {
            apiKey: "AIzaSyCXCsqN-xwQ-3_bt2dTaxbmywSW002zOW4",
            authDomain: "atlantic-fluids.firebaseapp.com",
            projectId: "atlantic-fluids",
            storageBucket: "atlantic-fluids.appspot.com",
            messagingSenderId: "92805829518",
            appId: "1:92805829518:web:4aadfe255fd9bdc2348adf"
        };

        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Get profile ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const profileId = urlParams.get('id');

        if (!profileId) {
            showError("No profile ID provided in URL");
        } else {
            loadProfile(profileId);
        }

        async function loadProfile(profileId) {
            try {
                const doc = await db.collection("contacts").doc(profileId).get();
                
                if (!doc.exists) {
                    showError("Profile not found");
                    return;
                }

                const profile = doc.data();
                console.log("Loaded profile data:", profile); // For debugging
                updateUI(profile);
            } catch (error) {
                showError(`Failed to load profile: ${error.message}`);
                console.error("Error loading profile:", error);
            }
        }

        function updateUI(profile) {
            // Update basic information
            document.getElementById('fullName').textContent = profile.fullname || profile.fullName || 'Atlantic Fluids';
            updateLogo(profile.logo || profile.companyLogo);
            updateWebsite(profile.website);
            updateAddress(profile.address);
            updateContacts(profile);
            updateSocialLinks(profile.social);
        }

        function updateLogo(logoPath) {
            const logoImg = document.querySelector('#companyLogo img');
            if (logoPath && typeof logoPath === 'string') {
                logoImg.src = logoPath;
            }
        }

        function updateWebsite(websiteUrl) {
            const websiteElement = document.getElementById('website');
            if (websiteUrl && isValidUrl(websiteUrl)) {
                websiteElement.href = websiteUrl;
                websiteElement.querySelector('span').textContent = 
                    new URL(websiteUrl).hostname.replace('www.', '');
            } else {
                websiteElement.querySelector('span').textContent = 'Website not available';
                websiteElement.removeAttribute('href');
            }
        }

        function updateAddress(address) {
            const addressElement = document.getElementById('address');
            if (address && typeof address === 'string') {
                addressElement.querySelector('span').innerHTML = 
                    address.replace(/\n/g, '<br>');
            } else {
                addressElement.querySelector('span').textContent = 'Address not available';
            }
        }

        function updateContacts(profile) {
            populateContactList('emails', profile.emails, 'envelope', 'mailto:');
            populateContactList('phones', profile.phones, 'phone', 'tel:');
        }

        function populateContactList(containerId, items, iconType, prefix) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            if (Array.isArray(items) && items.length > 0) {
                items.forEach(item => {
                    const element = createContactElement(item, iconType, prefix);
                    container.appendChild(element);
                });
            }

            if (container.children.length === 0) {
                container.appendChild(createEmptyState(containerId));
            }
        }

        function createContactElement(value, icon, prefix) {
            const element = document.createElement('a');
            element.className = 'contact-item contact-link';
            element.href = `${prefix}${value}`;
            element.innerHTML = `
                <i class="fas fa-${icon}"></i>
                <span>${icon === 'phone' ? formatPhone(value) : value}</span>
            `;
            return element;
        }

        function createEmptyState(type) {
            const emptyState = document.createElement('div');
            emptyState.className = 'contact-item';
            emptyState.innerHTML = `
                <i class="fas fa-info-circle"></i>
                <span>No ${type} available</span>
            `;
            return emptyState;
        }

        function updateSocialLinks(socialData) {
            const container = document.getElementById('social-links');
            container.innerHTML = '';

            if (socialData && typeof socialData === 'object' && Object.keys(socialData).length > 0) {
                createSocialLinks(container, socialData);
            } else {
                container.appendChild(createSocialEmptyState());
            }
        }

        function createSocialLinks(container, socialData) {
            const platforms = [
                { name: 'facebook', icon: 'facebook-f' },
                { name: 'twitter', icon: 'twitter' },
                { name: 'linkedin', icon: 'linkedin-in' },
                { name: 'instagram', icon: 'instagram' }
            ];

            platforms.forEach(platform => {
                if (socialData[platform.name] && isValidUrl(socialData[platform.name])) {
                    const link = createSocialLink(platform, socialData[platform.name]);
                    container.appendChild(link);
                }
            });

            if (container.children.length === 0) {
                container.appendChild(createSocialEmptyState());
            }
        }

        function createSocialLink(platform, url) {
            const link = document.createElement('a');
            link.className = 'social-item';
            link.href = url;
            link.target = '_blank';
            link.rel = 'noopener noreferrer';
            link.innerHTML = `
                <i class="fab fa-${platform.icon}"></i>
                <span>${platform.name.charAt(0).toUpperCase() + platform.name.slice(1)}</span>
            `;
            return link;
        }

        function createSocialEmptyState() {
            const emptyState = document.createElement('div');
            emptyState.className = 'social-item';
            emptyState.innerHTML = `
                <i class="fas fa-info-circle"></i>
                <span>No social links available</span>
            `;
            return emptyState;
        }

        function formatPhone(phone) {
            // Check if phone is already formatted
            if (phone.includes('-') || phone.includes(' ') || phone.includes('(')) {
                return phone;
            }
            
            // Simple formatting for numbers
            const cleaned = phone.replace(/\D/g, '');
            if (cleaned.length === 10) {
                return `(${cleaned.slice(0, 3)}) ${cleaned.slice(3, 6)}-${cleaned.slice(6)}`;
            } else {
                return phone;
            }
        }

        function isValidUrl(url) {
            try {
                new URL(url);
                return true;
            } catch {
                return false;
            }
        }

        function showError(message) {
            const main = document.querySelector('main');
            main.innerHTML = `
                <div class="error-container">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3>${message}</h3>
                    <p>Please check the URL or try again later</p>
                </div>
            `;
            console.error(message);
        }
    </script>
</body>
</html>